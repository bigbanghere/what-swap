<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Comprehensive Rotation Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .test-case {
            background: white;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .test-title {
            font-weight: bold;
            color: #333;
            margin-bottom: 10px;
            font-size: 18px;
        }
        .test-steps {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 4px;
            margin: 10px 0;
        }
        .step {
            margin: 5px 0;
            padding: 5px 0;
        }
        .expected {
            background: #d4edda;
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
            border-left: 4px solid #28a745;
        }
        .note {
            background: #fff3cd;
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
            border-left: 4px solid #ffc107;
        }
        .critical {
            background: #f8d7da;
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
            border-left: 4px solid #dc3545;
        }
        .console-log {
            background: #e9ecef;
            padding: 10px;
            border-radius: 4px;
            font-family: monospace;
            font-size: 12px;
            margin: 10px 0;
            white-space: pre-wrap;
        }
        .status {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: bold;
        }
        .status.pending { background: #ffc107; color: #000; }
        .status.pass { background: #28a745; color: #fff; }
        .status.fail { background: #dc3545; color: #fff; }
    </style>
</head>
<body>
    <h1>ðŸ”„ Comprehensive Rotation Test Suite</h1>
    <p>This test suite verifies that all rotation scenarios work correctly after the recent fixes.</p>
    
    <div class="note">
        <strong>Test Environment:</strong> Navigate to <a href="http://localhost:3000" target="_blank">http://localhost:3000</a> and follow the test cases below.
    </div>

    <div class="test-case">
        <div class="test-title">Test Case 1: Default Value Rotation (No Focus) - FIXED</div>
        <div class="test-steps">
            <div class="step">1. Navigate to http://localhost:3000</div>
            <div class="step">2. Ensure no input field is focused (click outside the form)</div>
            <div class="step">3. Click the rotation button (circular arrow icon)</div>
            <div class="step">4. Verify that NO input field becomes focused after rotation</div>
            <div class="step">5. Verify that the default value "1" is preserved in the appropriate field</div>
        </div>
        <div class="expected">
            <strong>Expected Result:</strong> 
            <ul>
                <li>No input field should be focused after rotation</li>
                <li>The value "1" should be preserved in the field that receives it</li>
                <li>The other field should show the calculated amount</li>
            </ul>
        </div>
        <div class="status pending">PENDING</div>
    </div>

    <div class="test-case">
        <div class="test-title">Test Case 2: Default Value Rotation (With Focus) - FIXED</div>
        <div class="test-steps">
            <div class="step">1. Navigate to http://localhost:3000</div>
            <div class="step">2. Click on the Send field to focus it</div>
            <div class="step">3. Click the rotation button</div>
            <div class="step">4. Verify that focus transfers to the Get field (where the value moved)</div>
            <div class="step">5. Verify that the default value "1" is preserved in the Get field</div>
        </div>
        <div class="expected">
            <strong>Expected Result:</strong> 
            <ul>
                <li>Focus should transfer to the Get field after rotation</li>
                <li>The value "1" should be preserved in the Get field</li>
                <li>The Send field should show the calculated amount</li>
            </ul>
        </div>
        <div class="status pending">PENDING</div>
    </div>

    <div class="test-case">
        <div class="test-title">Test Case 3: Third Rotation Detection - FIXED</div>
        <div class="test-steps">
            <div class="step">1. Navigate to http://localhost:3000</div>
            <div class="step">2. Click the rotation button (1st rotation)</div>
            <div class="step">3. Click the rotation button again (2nd rotation)</div>
            <div class="step">4. Click the rotation button again (3rd rotation)</div>
            <div class="step">5. Verify that the system correctly detects the default value after each rotation</div>
            <div class="step">6. Check browser console for rotation logs</div>
        </div>
        <div class="expected">
            <strong>Expected Result:</strong> 
            <ul>
                <li>All three rotations should work correctly</li>
                <li>The system should properly detect which field contains the basis value (1)</li>
                <li>Console logs should show correct source field determination</li>
            </ul>
        </div>
        <div class="console-log">Expected console logs:
ðŸ”„ SwapForm: Value came from Send field (preserved basis, Send field contains basis value)
ðŸ”„ SwapForm: Value came from Get field (preserved basis, Get field contains basis value)
ðŸ”„ SwapForm: Value came from Send field (preserved basis, Send field contains basis value)</div>
        <div class="status pending">PENDING</div>
    </div>

    <div class="test-case">
        <div class="test-title">Test Case 4: Custom Value Rotation (Send Field Focused)</div>
        <div class="test-steps">
            <div class="step">1. Navigate to http://localhost:3000</div>
            <div class="step">2. Enter "100" in the Send field</div>
            <div class="step">3. Click the rotation button</div>
            <div class="step">4. Verify that "100" is preserved in the Get field</div>
            <div class="step">5. Verify that focus transfers to the Get field</div>
        </div>
        <div class="expected">
            <strong>Expected Result:</strong> 
            <ul>
                <li>The custom value "100" should be preserved in the Get field</li>
                <li>Focus should transfer to the Get field</li>
                <li>The Send field should show the calculated amount for the swapped tokens</li>
            </ul>
        </div>
        <div class="status pending">PENDING</div>
    </div>

    <div class="test-case">
        <div class="test-title">Test Case 5: Custom Value Rotation (Get Field Focused)</div>
        <div class="test-steps">
            <div class="step">1. Navigate to http://localhost:3000</div>
            <div class="step">2. Enter "50" in the Get field</div>
            <div class="step">3. Click the rotation button</div>
            <div class="step">4. Verify that "50" is preserved in the Send field</div>
            <div class="step">5. Verify that focus transfers to the Send field</div>
        </div>
        <div class="expected">
            <strong>Expected Result:</strong> 
            <ul>
                <li>The custom value "50" should be preserved in the Send field</li>
                <li>Focus should transfer to the Send field</li>
                <li>The Get field should show the calculated amount for the swapped tokens</li>
            </ul>
        </div>
        <div class="status pending">PENDING</div>
    </div>

    <div class="test-case">
        <div class="test-title">Test Case 6: Backspace Functionality - FIXED</div>
        <div class="test-steps">
            <div class="step">1. Navigate to http://localhost:3000</div>
            <div class="step">2. Enter "123" in the Send field</div>
            <div class="step">3. Press backspace to delete the "3"</div>
            <div class="step">4. Verify that the Send field shows "12"</div>
            <div class="step">5. Verify that the Get field recalculates based on "12"</div>
            <div class="step">6. Continue pressing backspace to test multiple deletions</div>
        </div>
        <div class="expected">
            <strong>Expected Result:</strong> 
            <ul>
                <li>Backspace should work properly in the Send field</li>
                <li>The Get field should recalculate correctly after each backspace</li>
                <li>No input should be overridden by calculation logic</li>
            </ul>
        </div>
        <div class="status pending">PENDING</div>
    </div>

    <div class="test-case">
        <div class="test-title">Test Case 7: Multiple Rotations with Custom Value</div>
        <div class="test-steps">
            <div class="step">1. Navigate to http://localhost:3000</div>
            <div class="step">2. Enter "200" in the Send field</div>
            <div class="step">3. Click rotation button (1st rotation)</div>
            <div class="step">4. Click rotation button (2nd rotation)</div>
            <div class="step">5. Click rotation button (3rd rotation)</div>
            <div class="step">6. Verify that "200" is always preserved in the appropriate field</div>
        </div>
        <div class="expected">
            <strong>Expected Result:</strong> 
            <ul>
                <li>The custom value "200" should be preserved through all rotations</li>
                <li>The value should alternate between Send and Get fields as the basis</li>
                <li>Focus should transfer correctly with each rotation</li>
            </ul>
        </div>
        <div class="status pending">PENDING</div>
    </div>

    <div class="critical">
        <strong>Critical Issues Fixed:</strong>
        <ul>
            <li>âœ… Backspace not working properly in send field</li>
            <li>âœ… Unwanted focus when rotating with unfocused field</li>
            <li>âœ… Third rotation incorrectly determining source field</li>
            <li>âœ… System not detecting default value after rotation</li>
        </ul>
    </div>

    <div class="note">
        <strong>Testing Instructions:</strong>
        <ol>
            <li>Open the test page in your browser</li>
            <li>Navigate to http://localhost:3000 in another tab</li>
            <li>Follow each test case step by step</li>
            <li>Update the status indicators (PENDING â†’ PASS/FAIL) based on results</li>
            <li>Check browser console for detailed rotation logs</li>
        </ol>
    </div>

    <script>
        // Auto-update status based on test results
        function updateStatus(testCase, passed) {
            const statusElement = testCase.querySelector('.status');
            statusElement.textContent = passed ? 'PASS' : 'FAIL';
            statusElement.className = `status ${passed ? 'pass' : 'fail'}`;
        }

        // Add click handlers for easy status updates
        document.querySelectorAll('.test-case').forEach((testCase, index) => {
            const statusElement = testCase.querySelector('.status');
            statusElement.addEventListener('click', () => {
                const currentStatus = statusElement.textContent;
                if (currentStatus === 'PENDING') {
                    const passed = confirm(`Did Test Case ${index + 1} pass?`);
                    updateStatus(testCase, passed);
                }
            });
        });
    </script>
</body>
</html>
